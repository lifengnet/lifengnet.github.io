webpackJsonp([10],{444:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(460),r=(a.n(n),a(461)),i=a.n(r),l=a(482),o=(a.n(l),a(483)),s=a.n(o),c=a(476),u=(a.n(c),a(477)),p=a.n(u),d=a(9),f=a.n(d),_=a(453),m=(a.n(_),a(458)),y=a.n(m),b=a(462),h=(a.n(b),a(463)),g=a.n(h),v=a(474),E=(a.n(v),a(475)),k=a.n(E),w=a(108),C=a.n(w),x=a(103),I=a.n(x),T=a(106),O=a.n(T),S=a(104),j=a.n(S),q=a(105),F=a.n(q),P=a(479),V=(a.n(P),a(480)),z=a.n(V),L=a(5),M=a.n(L),B=(a(28),a(179)),A=(a.n(B),a(568)),D=a(6),H=a(493),J=z.a.Item,N=g.a.Option,R=i.a.TabPane,G=k.a.TreeNode,K=function(e){function t(e){I()(this,t);var a=j()(this,(t.__proto__||C()(t)).call(this,e));return a.state={editType:"title",selfCategoryList:[],offers:[],values:{query_status:"published"}},a}return F()(t,e),O()(t,[{key:"componentDidMount",value:function(){var e=this;Object(D.a)({cmd:"alibaba.open.category.getselfcatlist",param:{member_id:"b2b-"+D.c.get("seller_id")},method:"get",success:function(t){e.setState({selfCategoryList:t.alibaba_open_category_getselfcatlist_response.result_objects.seller_cat_info[0].seller_cats.struct})},error:function(e){}})}},{key:"changeType",value:function(e){this.setState({editType:e})}},{key:"getFormItems",value:function(){var e=this,t=function e(t){return null!=t&&t.map?t.map(function(t){return t.childrens&&t.childrens.struct?M.a.createElement(G,{key:t.id,title:t.name,value:t.id},e(t.childrens.struct)):M.a.createElement(G,{key:t.id,title:t.name,value:t.id})}):null},a={formItems:[{label:"\u5b9d\u8d1d\u5206\u7c7b",labelCol:{span:4},wrapperCol:{span:8},custom:function(a,n){return M.a.createElement(J,null,a("query_selfCategory",{})(M.a.createElement(k.a,{dropdownStyle:{maxHeight:300,overflow:"auto"},placeholder:"\u8bf7\u9009\u62e9\uff0c\u6ca1\u6709\u9009\u62e9\u5219\u4e3a\u5168\u90e8\u5206\u7c7b"},t(e.state.selfCategoryList))))}},{label:"\u5b9d\u8d1d\u72b6\u6001",labelCol:{span:4},wrapperCol:{span:8},name:"query_status",radio:{radioValue:[{title:"\u51fa\u552e\u4e2d\u7684\u5b9d\u8d1d",value:"published"},{title:"\u4ed3\u5e93\u4e2d\u7684\u5b9d\u8d1d",value:"expired"}]}},{label:"\u6807\u9898\u5305\u542b",labelCol:{span:4},wrapperCol:{span:8},name:"query_title",input:{placeholder:"\u641c\u7d22\u5168\u90e8\u65e0\u9700\u586b\u5199"}},{custom:function(t,a){return M.a.createElement(i.a,{onChange:e.changeType.bind(e),size:"small",style:{margin:"10px"}},M.a.createElement(R,{tab:"\u4fee\u6539\u6807\u9898",key:"title"}),M.a.createElement(R,{tab:"\u4fee\u6539\u4ef7\u683c",key:"price"}),M.a.createElement(R,{tab:"\u4fee\u6539\u5e93\u5b58",key:"stock"}))}}],initValue:this.state.values};return"title"==this.state.editType?a.formItems=a.formItems.concat([{label:"\u5220\u9664\u6807\u9898\u5173\u952e\u5b57",labelCol:{span:4},wrapperCol:{span:8},name:"del_title",input:{placeholder:"\u8f93\u5165\u8981\u5220\u9664\u7684\u5173\u952e\u5b57"}},{label:"\u66ff\u6362\u6807\u9898\u5173\u952e\u5b57",labelCol:{span:4},wrapperCol:{span:8},custom:function(e,t){return M.a.createElement("div",null,M.a.createElement(J,{style:{width:100,display:"inline-block",margin:"0 5px"}},e("relpace_title_from",{})(M.a.createElement(y.a,null))),M.a.createElement("span",null,">\u66ff\u6362\u6210>"),M.a.createElement(J,{style:{width:100,display:"inline-block",margin:"0 5px"}},e("relpace_title_to",{})(M.a.createElement(y.a,null))))}},{label:"\u6dfb\u52a0\u6807\u9898\u524d/\u540e\u7f00",labelCol:{span:4},wrapperCol:{span:8},custom:function(e,t){return M.a.createElement("div",null,M.a.createElement(J,{style:{width:100,display:"inline-block",margin:"0 5px"}},e("add_title_befor",{})(M.a.createElement(y.a,null))),M.a.createElement("span",null,"+\u539f\u6807\u9898+"),M.a.createElement(J,{style:{width:100,display:"inline-block",margin:"0 5px"}},e("add_title_after",{})(M.a.createElement(y.a,null))))}}]):"price"==this.state.editType?a.formItems=a.formItems.concat([{label:"\u539f\u4ef7\u683c",labelCol:{span:4},wrapperCol:{span:8},custom:function(e,t){return M.a.createElement("div",null,M.a.createElement(J,{style:{width:100,display:"inline-block",margin:"0 5px"}},e("edit_price_operation",{initialValue:"add"})(M.a.createElement(g.a,{style:{width:120}},M.a.createElement(N,{value:"add"},"\u52a0"),M.a.createElement(N,{value:"subtract"},"\u51cf"),M.a.createElement(N,{value:"multiply"},"\u4e58"),M.a.createElement(N,{value:"divide"},"\u9664")))),M.a.createElement("span",{style:{margin:"0 10px"}}),M.a.createElement(J,{style:{width:100,display:"inline-block",margin:"0 5px"}},e("edit_price_value",{})(M.a.createElement(y.a,null))))}}]):"stock"==this.state.editType&&(a.formItems=a.formItems.concat([{label:"\u539f\u5e93\u5b58(\u4ef6)",labelCol:{span:4},wrapperCol:{span:8},custom:function(e,t){return M.a.createElement("div",null,M.a.createElement(J,{style:{width:100,display:"inline-block",margin:"0 5px"}},e("edit_stock_operation",{initialValue:"add"})(M.a.createElement(g.a,{style:{width:120}},M.a.createElement(N,{value:"add"},"\u52a0"),M.a.createElement(N,{value:"subtract"},"\u51cf"),M.a.createElement(N,{value:"multiply"},"\u4e58"),M.a.createElement(N,{value:"divide"},"\u9664")))),M.a.createElement("span",{style:{margin:"0 10px"}}),M.a.createElement(J,{style:{width:100,display:"inline-block",margin:"0 5px"}},e("edit_stock_value",{})(M.a.createElement(y.a,null))))}}])),a}},{key:"getButtonOptions",value:function(){var e=this;return{buttons:[{name:"\u5f00\u59cb\u4fee\u6539",type:"primary",shouldCheck:!0,handle:function(t){e.doSubmit(t)}},{name:"\u9884\u89c8\u4fee\u6539\u7ed3\u679c",handle:function(t){e.view(t)}}]}}},{key:"getOfferPage",value:function(e,t,a){var n=this,r={};r.page_no=e,r.page_size=50,r.return_fields="sku_pics,is_price_auth_offer,post_categry_id,offer_id,offer_status,is_private,member_id,subject,quality_level,image_list,product_feature_list,is_offer_support_online_trade,trading_type,is_support_mix,amount,amount_on_sale,saled_count,retail_price,unit_price,price_ranges,term_offer_process,is_sku_offer,is_sku_trade_supported,sku_array,gmt_create,gmt_modified,gmt_last_repost,gmt_approved,gmt_expire",r.status="published",r.member_id="b2b-"+D.c.get("seller_id"),t.query_selfCategory&&(r.group_ids=t.query_selfCategory),t.query_status&&(r.status=t.query_status),t.query_title&&(r.q=t.query_title),Object(D.a)({cmd:"alibaba.open.offer.search",param:r,method:"get",success:function(r){var i=null;1===e?i=r.alibaba_open_offer_search_response.offer_list.offer_detail_info:(i=n.state.offers,i=i.concat(r.alibaba_open_offer_search_response.offer_list.offer_detail_info)),n.setState({offers:i});var l=r.alibaba_open_offer_search_response.total,o=0;o=l%50==0?parseInt(l/50):parseInt(l/50)+1,e<o?n.getOfferPage(++e,t,a):a()},error:function(e){}})}},{key:"modifyTitle",value:function(e,t){return t.del_title&&(e=e.replace(t.del_title,"")),t.relpace_title_from&&(e=e.replace(t.relpace_title_from,null==t.relpace_title_to?"":t.relpace_title_to)),t.add_title_befor&&(e=t.add_title_befor+e),t.add_title_after&&(e+=t.add_title_after),e}},{key:"modifyStock",value:function(e,t){return"add"===t.edit_stock_operation?e+=parseInt(t.edit_stock_value):"subtract"===t.edit_stock_operation?e-=parseInt(t.edit_stock_value):"multiply "===t.edit_stock_operation?e*=parseInt(t.edit_stock_value):"divide"===t.edit_stock_operation&&(e=parseInt(e/parseInt(t.edit_stock_value))),e}},{key:"modifyPrice",value:function(e,t){return"add"===t.edit_price_operation?e=parseFloat(e)+parseFloat(t.edit_price_value):"subtract"===t.edit_price_operation?e=parseFloat(e)-parseFloat(t.edit_price_value):"multiply "===t.edit_price_operation?e=parseFloat(e)*parseFloat(t.edit_price_value):"divide"===t.edit_price_operation&&(e=parseFloat(parseFloat(e)/parseFloat(t.edit_price_value))),e}},{key:"doSubmit",value:function(e){var t=this,a=this;e.editType=this.state.editType,e.mode="edit",this.getOfferPage(1,e,function(){var n=t.state.offers;if("title"===e.editType){var r=0;n.forEach(function(t,i){Object(D.a)({cmd:"alibaba.open.offer.modify.increment",param:{offer:f()({offerId:t.offer_id+"",subject:a.modifyTitle(t.subject,e)})},method:"post",success:function(e){r++,i===n.length-1&&p.a.success("\u4fee\u6539\u6210\u529f")},error:function(e){i===n.length-1&&p.a.error("\u4fee\u6539\u5931\u8d25")}})})}else if("price"===e.editType){var i=0;n.forEach(function(t,r){if(t.price_ranges&&t.price_ranges.price_range_info){var l=[];t.price_ranges.price_range_info.forEach(function(t){var n={price:a.modifyPrice(t.price,e)+"",convertPrice:a.modifyPrice(t.price,e)+"",range:t.range};l.push(n)}),Object(D.a)({cmd:"alibaba.open.offer.modify.increment",param:{offer:f()({offerId:t.offer_id+"",priceRanges:f()(l)})},method:"post",success:function(e){i++,r===n.length-1&&p.a.success("\u4fee\u6539\u6210\u529f")},error:function(e){r===n.length-1&&p.a.error("\u4fee\u6539\u5931\u8d25")}})}})}else if("stock"===e.editType){var l=0;n.forEach(function(t,r){Object(D.a)({cmd:"alibaba.open.offer.modify.increment",param:{offer:f()({offerId:t.offer_id+"",amountOnSale:a.modifyStock(t.amount_on_sale,e)+""})},method:"post",success:function(e){l++,r===n.length-1&&p.a.success("\u4fee\u6539\u6210\u529f")},error:function(e){r===n.length-1&&p.a.error("\u4fee\u6539\u5931\u8d25")}})})}})}},{key:"view",value:function(e){var t=this,a=this;this.getOfferPage(1,e,function(){var n=[{title:"\u5e8f\u53f7",dataIndex:"index",render:function(e,t,a){return a+1}},{title:"\u56fe\u7247",dataIndex:"image",render:function(e,t,a){return M.a.createElement("img",{src:e})}},{title:"\u6807\u9898",dataIndex:"subject"}];"title"===t.state.editType?n.push({title:"\u4fee\u6539\u540e\u6807\u9898",dataIndex:"newSubject",render:function(t,n,r){return M.a.createElement("span",null,a.modifyTitle(n.subject,e))}}):"price"===t.state.editType||"stock"===t.state.editType&&(n.push({title:"\u539f\u5e93\u5b58",dataIndex:"amount_on_sale"}),n.push({title:"\u4fee\u6539\u540e\u5e93\u5b58",dataIndex:"newAmount",render:function(t,n,r){return M.a.createElement("span",null,a.modifyStock(n.amount_on_sale,e))}})),H.a.show({title:"\u9884\u89c8\u4fee\u6539\u7ed3\u679c",width:"80%",footer:{readonly:!1,okText:"\u5f00\u59cb\u4fee\u6539"},onOk:function(t){a.doSubmit(e),H.a.destory()},onCancel:function(){H.a.destory()},onClose:function(){H.a.destory()},content:M.a.createElement("div",{style:{"max-height":"calc(100vh - 260px)",overflow:"auto"}},M.a.createElement(s.a,{pagination:!1,columns:n,dataSource:a.state.offers}))})})}},{key:"changeMenu",value:function(e){window.location.hash="/batch-edit/"+e}},{key:"render",value:function(){return M.a.createElement("div",null,M.a.createElement(i.a,{size:"small",style:{margin:"10px"}},M.a.createElement(R,{tab:"\u9009\u62e9\u5b9d\u8d1d\u8303\u56f4",key:"11"})),M.a.createElement(A.a,{items:this.getFormItems(),buttonOption:this.getButtonOptions(),onSubmit:this.doSubmit}))}}]),t}(L.Component),Q=function(e){return{}},U=function(e){return{}};t.default=Object(B.connect)(Q,U)(K)}});